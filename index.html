<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- ===== SEO ===== -->
    <title>ã˜ã‹ã‚“ã‚ã‚Šãƒ¡ãƒ¼ã‚«ãƒ¼ï½œå­ã©ã‚‚ç”¨ãƒ»ã‹ã‚ã„ã„æ™‚é–“å‰²ã‚’ç„¡æ–™ã§ä½œæˆãƒ»å°åˆ·</title>
    <meta name="description" content="å°å­¦ç”Ÿãƒ»å¹¼å…å‘ã‘ã®æ™‚é–“å‰²ãƒ¡ãƒ¼ã‚«ãƒ¼ã§ã™ã€‚ã‚¢ãƒŠãƒ­ã‚°æ™‚è¨ˆã¤ãã®ã‹ã‚ã„ã„ãƒ‡ã‚¶ã‚¤ãƒ³ã§ã€A4ç”¨ç´™ã«å°åˆ·ã§ãã¾ã™ã€‚è‰²ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒé¸ã¹ã¦ã‚¹ãƒãƒ›ã‹ã‚‰ã‚‚ä½œã‚Œã¾ã™ã€‚ç„¡æ–™ãƒ»ç™»éŒ²ä¸è¦ã€‚">
    <meta name="keywords" content="æ™‚é–“å‰²,ã˜ã‹ã‚“ã‚ã‚Š,æ™‚é–“å‰²ãƒ¡ãƒ¼ã‚«ãƒ¼,å­ã©ã‚‚,å°å­¦ç”Ÿ,å¹¼å…,ç„¡æ–™,å°åˆ·,ã‹ã‚ã„ã„,ã‚«ãƒ©ãƒ¼,ã‚¢ãƒŠãƒ­ã‚°æ™‚è¨ˆ,A4,ã‚¹ãƒãƒ›">
    <meta name="author" content="ã˜ã‹ã‚“ã‚ã‚Šãƒ¡ãƒ¼ã‚«ãƒ¼">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://hsgw-k.github.io/kids-schedule-maker/">

    <!-- ===== OGPï¼ˆSNSã‚·ã‚§ã‚¢ç”¨ï¼‰ ===== -->
    <meta property="og:title" content="ã˜ã‹ã‚“ã‚ã‚Šãƒ¡ãƒ¼ã‚«ãƒ¼ï½œå­ã©ã‚‚ç”¨ãƒ»ã‹ã‚ã„ã„æ™‚é–“å‰²ã‚’ç„¡æ–™ã§ä½œæˆ">
    <meta property="og:description" content="ã‚¢ãƒŠãƒ­ã‚°æ™‚è¨ˆã¤ããƒ»ã‹ã‚ã„ã„ãƒ‡ã‚¶ã‚¤ãƒ³ã®å­ã©ã‚‚ç”¨æ™‚é–“å‰²ãƒ¡ãƒ¼ã‚«ãƒ¼ã€‚A4å°åˆ·å¯¾å¿œã€ã‚¹ãƒãƒ›ã§ã‚‚ä½¿ãˆã¾ã™ã€‚">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://hsgw-k.github.io/kids-schedule-maker/">
    <meta property="og:locale" content="ja_JP">

    <!-- ===== Twitter Card ===== -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="ã˜ã‹ã‚“ã‚ã‚Šãƒ¡ãƒ¼ã‚«ãƒ¼ï½œå­ã©ã‚‚ç”¨ãƒ»ç„¡æ–™ã§ä½œæˆãƒ»å°åˆ·">
    <meta name="twitter:description" content="ã‚¢ãƒŠãƒ­ã‚°æ™‚è¨ˆã¤ããƒ»ã‹ã‚ã„ã„ãƒ‡ã‚¶ã‚¤ãƒ³ã®å­ã©ã‚‚ç”¨æ™‚é–“å‰²ãƒ¡ãƒ¼ã‚«ãƒ¼ã€‚ã‚¹ãƒãƒ›ã§ã‚‚ä½¿ãˆã¾ã™ã€‚">

    <!-- ===== PWA / ãƒ–ãƒ©ã‚¦ã‚¶UI ===== -->
    <meta name="theme-color" content="#7BBF6A">

    <!-- ===== ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ï¼ˆæ™‚è¨ˆSVGï¼‰ ===== -->
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%237BBF6A'/%3E%3Ccircle cx='50' cy='50' r='42' fill='white'/%3E%3Ccircle cx='50' cy='50' r='42' fill='none' stroke='%23222' stroke-width='2.5'/%3E%3Cline x1='50' y1='13' x2='50' y2='20' stroke='%23555' stroke-width='2.5' stroke-linecap='round'/%3E%3Cline x1='87' y1='50' x2='80' y2='50' stroke='%23555' stroke-width='2.5' stroke-linecap='round'/%3E%3Cline x1='50' y1='87' x2='50' y2='80' stroke='%23555' stroke-width='2.5' stroke-linecap='round'/%3E%3Cline x1='13' y1='50' x2='20' y2='50' stroke='%23555' stroke-width='2.5' stroke-linecap='round'/%3E%3Cline x1='50' y1='50' x2='34' y2='27' stroke='%23222' stroke-width='5' stroke-linecap='round'/%3E%3Cline x1='50' y1='50' x2='69' y2='27' stroke='%23E04040' stroke-width='3.5' stroke-linecap='round'/%3E%3Ccircle cx='50' cy='50' r='4' fill='%23222'/%3E%3C/svg%3E">


    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --green-bg: #7BBF6A;
            --cream: #F5F0DC;
            --white: #FFFFFF;
            --dark: #1A1A1A;
            --red-del: #E03030;
            --blue-btn: #4A90E2;
            --border: #D0C8B0;
            --mid: #666;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html,
        body {
            height: 100%;
            font-family: 'Zen Maru Gothic', sans-serif;
            font-weight: 500;
            background: #E8E8E8;
            color: var(--dark);
        }

        /* ===== ãƒ˜ãƒƒãƒ€ãƒ¼ ===== */
        header {
            background: var(--green-bg);
            color: white;
            text-align: center;
            padding: 12px 20px;
            font-size: 1.25rem;
            font-weight: 700;
            letter-spacing: 0.08em;
        }

        /* ===== ãƒ¡ã‚¤ãƒ³ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ ===== */
        .app-container {
            display: flex;
            gap: 20px;
            padding: 16px 20px;
            align-items: flex-start;
            /* ãƒ˜ãƒƒãƒ€ãƒ¼é«˜ã•åˆ†ã‚’å¼•ã„ã¦æ®‹ã‚Šå…¨é«˜ã•ã‚’ä½¿ã† */
            height: calc(100vh - 52px);
            overflow: hidden;
        }

        /* ===== å·¦ãƒ‘ãƒãƒ« ===== */
        .input-panel {
            width: 410px;
            min-width: 410px;
            flex-shrink: 0;
            background: var(--green-bg);
            border-radius: 20px;
            padding: 12px;
            height: 100%;
            overflow-y: auto;
            /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã‚’ã™ã£ãã‚Šã•ã›ã‚‹ */
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.4) transparent;
        }

        .input-panel::-webkit-scrollbar {
            width: 5px;
        }

        .input-panel::-webkit-scrollbar-track {
            background: transparent;
        }

        .input-panel::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.4);
            border-radius: 4px;
        }

        .input-inner {
            background: var(--cream);
            border-radius: 14px;
            padding: 16px 8px 14px;
        }

        .field-label {
            display: block;
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 6px;
        }

        .name-section {
            margin-bottom: 12px;
        }

        .text-input {
            width: 100%;
            padding: 9px 12px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            font-family: 'Zen Maru Gothic', sans-serif;
            font-weight: 500;
            background: var(--white);
            color: var(--dark);
            transition: border-color 0.2s;
        }

        .text-input:focus {
            outline: none;
            border-color: var(--blue-btn);
        }

        .schedule-item {
            background: var(--white);
            border-radius: 12px;
            padding: 7px 11px;
            margin-bottom: 6px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.07);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }

        .del-btn {
            background: none;
            border: none;
            color: var(--red-del);
            font-size: 1.1rem;
            font-family: 'Zen Maru Gothic', sans-serif;
            font-weight: 700;
            cursor: pointer;
            padding: 2px 6px;
            min-width: 32px;
            min-height: 32px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
        }

        .del-btn:hover {
            opacity: 0.7;
            background: rgba(220, 50, 50, 0.08);
        }

        .time-row {
            display: flex;
            align-items: center;
            gap: 5px;
            /* margin-bottom ãªã—ï¼šact-inputã‚’æ¨ªã«ä¸¦ã¹ã‚‹ã®ã§ä¸‹ä½™ç™½ä¸è¦ */
        }

        .time-sel {
            padding: 5px 6px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.9rem;
            font-family: 'Zen Maru Gothic', sans-serif;
            font-weight: 500;
            background: var(--white);
            color: var(--dark);
            cursor: pointer;
        }

        .time-sel:focus {
            outline: none;
            border-color: var(--blue-btn);
        }

        .colon {
            font-weight: 700;
            font-size: 1rem;
        }

        /* æ™‚åˆ»è¡Œï¼šæ™‚åˆ»ã‚»ãƒ¬ã‚¯ãƒˆ + è¡Œå‹•å†…å®¹å…¥åŠ›ã‚’æ¨ªä¸¦ã³ */
        .time-act-row {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 0;
        }

        .act-input {
            flex: 1;
            min-width: 80px;
            /* æœ€ä½å¹…ã‚’ç¢ºä¿ã—ã¦å·¦å³ã‚’åºƒã */
            padding: 5px 8px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.9rem;
            font-family: 'Zen Maru Gothic', sans-serif;
            font-weight: 500;
            background: var(--white);
            color: var(--dark);
        }

        .act-input:focus {
            outline: none;
            border-color: var(--blue-btn);
        }

        .act-input::placeholder {
            color: #bbb;
        }

        .add-btn {
            width: 100%;
            padding: 10px;
            background: var(--white);
            border: 2.5px solid var(--dark);
            border-radius: 12px;
            font-size: 0.93rem;
            font-family: 'Zen Maru Gothic', sans-serif;
            font-weight: 700;
            color: var(--dark);
            cursor: pointer;
            margin-bottom: 8px;
            transition: background 0.15s;
        }

        .add-btn:hover {
            background: #f0f0f0;
        }

        .add-btn:disabled {
            opacity: 0.35;
            cursor: not-allowed;
        }

        .count-info {
            text-align: center;
            font-size: 0.75rem;
            color: var(--mid);
            margin-bottom: 8px;
        }

        .layout-badge {
            display: inline-block;
            background: #888;
            color: white;
            padding: 1px 7px;
            border-radius: 8px;
            font-size: 0.7rem;
            margin-left: 4px;
            font-weight: 700;
        }

        .pdf-btn {
            width: 100%;
            padding: 13px;
            background: var(--blue-btn);
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Zen Maru Gothic', sans-serif;
            font-weight: 700;
            color: white;
            cursor: pointer;
            letter-spacing: 0.05em;
            box-shadow: 0 3px 0 #2a6aaa;
            transition: all 0.15s;
        }

        .pdf-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 0 #2a6aaa;
        }

        .pdf-btn:active {
            transform: translateY(1px);
            box-shadow: 0 1px 0 #2a6aaa;
        }

        /* ===== å³ãƒ‘ãƒãƒ« ===== */
        .preview-panel {
            flex: 1;
            min-width: 0;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .preview-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 10px;
            flex-shrink: 0;
        }

        /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ï¼šæ®‹ã‚Šé«˜ã•ã‚’å…¨éƒ¨ä½¿ã† */
        .preview-outer {
            flex: 1;
            min-height: 0;
            overflow: hidden;
            position: relative;
        }

        .preview-scaler {
            transform-origin: top left;
            position: absolute;
            top: 0;
            left: 0;
        }

        /* A4ã‚·ãƒ¼ãƒˆ */
        .a4-sheet {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.15);
        }

        /* A4 pxå¯¸æ³•ï¼ˆ96dpiåŸºæº–ï¼‰: 210Ã—297mm â†’ 794Ã—1123px */
        .a4-sheet.portrait {
            width: 794px;
            height: 1123px;
        }

        .a4-sheet.landscape {
            width: 1123px;
            height: 794px;
        }

        .sheet-inner {
            width: 100%;
            height: 100%;
            padding: 44px 52px;
            display: flex;
            flex-direction: column;
        }

        /* ã‚¿ã‚¤ãƒˆãƒ«ï¼šä¸­å¤®æƒãˆ */
        .sheet-title {
            display: flex;
            align-items: center;
            justify-content: center;
            /* â† å·¦å³ä¸­å¤® */
            gap: 14px;
            margin-bottom: 24px;
            flex-shrink: 0;
        }

        .sheet-title .name-box {
            background: transparent;
            color: #222;
            border: 4px solid #222;
            border-radius: 14px;
            padding: 8px 28px;
            font-size: 2.6rem;
            font-weight: 700;
            min-width: 100px;
            text-align: center;
            font-family: 'Zen Maru Gothic', sans-serif;
        }

        .sheet-title .title-text {
            font-size: 2.6rem;
            font-weight: 700;
            font-family: 'Zen Maru Gothic', sans-serif;
            color: var(--dark);
        }

        /* ã‚¨ãƒ³ãƒˆãƒªãƒ©ãƒƒãƒ‘ãƒ¼ â€” å…¨é …ç›®æ•°ã§å¸¸ã«space-evenly */
        .entries-wrap {
            flex: 1;
            min-height: 0;
            display: flex;
            flex-direction: column;
            justify-content: space-evenly;
            align-items: stretch;
        }

        /* 6ã€œ10é …ç›®ï¼š2ã‚«ãƒ©ãƒ ã‚°ãƒªãƒƒãƒ‰ */
        .entries-wrap.two-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px 80px;
            align-items: start;
        }

        /* å±±å½¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼šæ¨ª1åˆ— */
        .entry-row {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 6px 0;
        }

        /* 2åˆ—ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼šæ™‚è¨ˆ + å³å´ç¸¦ç©ã¿ */
        .entries-wrap.two-col .entry-row {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 12px;
            padding: 0;
        }

        /* 2åˆ—æ™‚ã®å³å´ï¼šãƒ©ãƒ™ãƒ« + ã˜ã‹ã‚“ã‚’ç¸¦ç©ã¿ */
        .entry-right {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .entry-clock {
            flex-shrink: 0;
            align-self: center;
        }

        /* æ™‚è¨ˆï¼‹ç•ªå·ã®ãƒ©ãƒƒãƒ‘ãƒ¼ï¼ˆ2åˆ—æ™‚ã®ã¿ï¼‰ */
        .entry-clock-wrap {
            position: relative;
            flex-shrink: 0;
            align-self: center;
        }

        /* æ™‚è¨ˆã®å·¦ä¸Šã«è¡¨ç¤ºã™ã‚‹ç•ªå· */
        .entry-num {
            position: absolute;
            top: -4px;
            left: -6px;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            font-size: 0.78rem;
            font-weight: 700;
            font-family: 'Zen Maru Gothic', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);
        }

        .entry-label {
            flex: 1;
            border-radius: 16px;
            padding: 12px 18px;
            font-size: 1.6rem;
            font-weight: 700;
            text-align: center;
            min-width: 0;
            word-break: break-all;
            font-family: 'Zen Maru Gothic', sans-serif;
            /* colorã¯JSã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«ã§åˆ¶å¾¡ï¼ˆãƒ†ãƒ¼ãƒé€£å‹•ï¼‰ */
            display: flex;
            align-items: center;
            justify-content: center;
            align-self: center;
        }

        /* 2åˆ—æ™‚ã®ãƒ©ãƒ™ãƒ«ï¼šflex:1ã‚’è§£é™¤ã—ãƒ–ãƒ­ãƒƒã‚¯å±•é–‹ */
        .entries-wrap.two-col .entry-label {
            flex: none;
            align-self: stretch;
            padding: 10px 12px;
            font-size: 1.3rem;
        }

        .entry-jikan {
            font-size: 1.5rem;
            color: var(--dark);
            white-space: nowrap;
            font-weight: 700;
            font-family: 'Zen Maru Gothic', sans-serif;
            align-self: center;
        }

        /* 2åˆ—æ™‚ã®ã˜ã‹ã‚“ï¼šãƒ©ãƒ™ãƒ«ã¨ä¸­å¤®æƒãˆ */
        .entries-wrap.two-col .entry-jikan {
            font-size: 1.0rem;
            font-weight: 700;
            align-self: center;
        }

        /* ===== ã‚«ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³é¸æŠ ===== */
        .color-section {
            margin-bottom: 10px;
        }

        .color-section .field-label {
            display: block;
            margin-bottom: 6px;
        }

        .color-patterns {
            display: flex;
            flex-wrap: nowrap;
            gap: 3px;
        }

        .color-btn {
            display: flex;
            align-items: center;
            gap: 3px;
            padding: 4px 5px;
            border: 2px solid transparent;
            border-radius: 8px;
            background: var(--white);
            cursor: pointer;
            font-size: 0.68rem;
            font-family: 'Zen Maru Gothic', sans-serif;
            font-weight: 700;
            color: var(--dark);
            white-space: nowrap;
            flex: 1;
            justify-content: center;
            transition: border-color 0.15s, transform 0.1s;
        }

        .color-btn:hover {
            transform: scale(1.03);
        }

        .color-btn.active {
            border-color: var(--dark);
        }

        .color-swatch {
            display: flex;
            gap: 2px;
        }

        .color-swatch span {
            width: 8px;
            height: 8px;
            border-radius: 2px;
            display: inline-block;
        }

        /* ===== ãƒ¢ãƒã‚¤ãƒ«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³ï¼ˆPCæ™‚ã¯éè¡¨ç¤ºï¼‰===== */
        .mobile-preview-btn {
            display: none;
        }

        /* ===== ãƒ¢ãƒã‚¤ãƒ«ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆPCæ™‚ã¯éè¡¨ç¤ºï¼‰===== */
        .mobile-modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            align-items: flex-start;
            justify-content: center;
            padding: 0;
            overflow: hidden;
        }

        .mobile-modal-overlay.open {
            display: flex;
        }

        .mobile-modal {
            background: #fff;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .mobile-modal-header {
            background: var(--green-bg);
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            flex-shrink: 0;
        }

        .mobile-modal-header .modal-title {
            font-size: 1.1rem;
            font-weight: 700;
            font-family: 'Zen Maru Gothic', sans-serif;
        }

        .mobile-modal-close {
            background: rgba(255, 255, 255, 0.25);
            border: none;
            color: white;
            font-size: 1.4rem;
            line-height: 1;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: sans-serif;
            transition: background 0.2s;
        }

        .mobile-modal-close:hover {
            background: rgba(255, 255, 255, 0.4);
        }

        .mobile-modal-body {
            flex: 1;
            overflow: auto;
            background: #E8E8E8;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding: 12px;
            -webkit-overflow-scrolling: touch;
        }

        .mobile-modal-preview-outer {
            width: 100%;
            display: flex;
            align-items: flex-start;
            justify-content: center;
        }

        .mobile-modal-preview-scaler {
            transform-origin: top center;
        }

        .mobile-modal-footer {
            background: var(--cream);
            border-top: 2px solid var(--border);
            padding: 12px 16px 16px;
            flex-shrink: 0;
        }

        .mobile-pdf-btn {
            width: 100%;
            padding: 16px;
            background: #4A90E2;
            color: white;
            border: none;
            border-radius: 14px;
            font-size: 1.1rem;
            font-weight: 700;
            font-family: 'Zen Maru Gothic', sans-serif;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 3px 10px rgba(74, 144, 226, 0.35);
            transition: transform 0.15s, box-shadow 0.15s;
        }

        .mobile-pdf-btn:active {
            transform: scale(0.97);
            box-shadow: 0 1px 5px rgba(74, 144, 226, 0.25);
        }

        /* ===== ãƒ¢ãƒã‚¤ãƒ«ï¼ˆã€œ1024pxï¼‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ ===== */
        @media (max-width: 1024px) {

            /* PCç”¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‘ãƒãƒ«ã‚’éè¡¨ç¤º */
            .preview-panel {
                display: none !important;
            }

            /* app-containerã‚’ã‚·ãƒ³ã‚°ãƒ«ã‚«ãƒ©ãƒ ã« */
            .app-container {
                flex-direction: column;
                height: auto;
                min-height: calc(100vh - 52px);
                overflow: visible;
                padding: 12px;
                gap: 0;
            }

            /* å…¥åŠ›ãƒ‘ãƒãƒ«ã‚’å…¨å¹…ã« */
            .input-panel {
                width: 100%;
                min-width: 0;
                height: auto;
                overflow-y: visible;
                border-radius: 16px;
                padding-bottom: 12px;
            }

            /* ãƒ¢ãƒã‚¤ãƒ«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºï¼ˆç”»é¢ä¸‹éƒ¨ã«å›ºå®šï¼‰ */
            .mobile-preview-btn {
                display: flex;
                position: fixed;
                bottom: 16px;
                left: 12px;
                right: 12px;
                width: auto;
                padding: 16px;
                background: #4B97D4;
                color: white;
                border: none;
                border-radius: 14px;
                font-size: 1.1rem;
                font-weight: 700;
                font-family: 'Zen Maru Gothic', sans-serif;
                cursor: pointer;
                align-items: center;
                justify-content: center;
                gap: 8px;
                box-shadow: 0 4px 16px rgba(0, 0, 0, 0.25);
                transition: transform 0.15s, box-shadow 0.15s;
                z-index: 100;
            }

            .mobile-preview-btn:active {
                transform: scale(0.97);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            }

            /* å›ºå®šãƒœã‚¿ãƒ³åˆ†ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’ä¸‹éƒ¨ã«ç¢ºä¿ */
            .app-container {
                padding-bottom: 88px !important;
            }

            /* PCç”¨PDFãƒœã‚¿ãƒ³ã‚’ãƒ¢ãƒã‚¤ãƒ«ã§ã¯éè¡¨ç¤ºï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«å†…ã®ãƒœã‚¿ãƒ³ã‚’ä½¿ã†ï¼‰ */
            #pdfBtn {
                display: none;
            }
        }
    </style>
</head>

<body>

    <header>ğŸŒŸ ã˜ã‹ã‚“ã‚ã‚Šãƒ¡ãƒ¼ã‚«ãƒ¼ ğŸŒŸ</header>

    <div class="app-container">
        <!-- å·¦ï¼šå…¥åŠ› -->
        <div class="input-panel">
            <div class="input-inner">
                <div class="name-section">
                    <label class="field-label">ãŠãªã¾ãˆ</label>
                    <input type="text" id="nameInput" class="text-input" placeholder="ãªã¾ãˆã‚’ã„ã‚Œã¦ã­" maxlength="10">
                </div>
                <!-- ã‚«ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³é¸æŠ -->
                <div class="color-section">
                    <label class="field-label">ã„ã‚ã®ãƒ‘ã‚¿ãƒ¼ãƒ³</label>
                    <div class="color-patterns">
                        <button class="color-btn active" id="colorBtn0" data-pattern="0">
                            <div class="color-swatch">
                                <span style="background:#F5A623"></span>
                                <span style="background:#F06292"></span>
                                <span style="background:#4CAF50"></span>
                            </div>
                            ãƒ“ãƒ“ãƒƒãƒˆ
                        </button>
                        <button class="color-btn" id="colorBtn1" data-pattern="1">
                            <div class="color-swatch">
                                <span style="background:#FFD6A5"></span>
                                <span style="background:#FFADAD"></span>
                                <span style="background:#CAFFBF"></span>
                            </div>
                            ãƒ‘ã‚¹ãƒ†ãƒ«
                        </button>
                        <button class="color-btn" id="colorBtn2" data-pattern="2">
                            <div class="color-swatch">
                                <span style="background:#E8D5B7"></span>
                                <span style="background:#D4B896"></span>
                                <span style="background:#C9A87C"></span>
                            </div>
                            ãƒŠãƒãƒ¥ãƒ©ãƒ«
                        </button>
                        <button class="color-btn" id="colorBtn3" data-pattern="3">
                            <div class="color-swatch">
                                <span style="background:#BDBDBD"></span>
                                <span style="background:#9E9E9E"></span>
                                <span style="background:#757575"></span>
                            </div>
                            ã‚°ãƒ¬ãƒ¼
                        </button>
                    </div>
                </div>
                <div id="scheduleList"></div>
                <button class="add-btn" id="addBtn">ï¼‹ ã‚ˆã¦ã„ã‚’ãµã‚„ã™</button>
                <div class="count-info" id="countInfo"></div>
                <button class="pdf-btn" id="pdfBtn">PDFã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
            </div>
        </div>

        <!-- å³ï¼šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆPCç”¨ï¼‰ -->
        <div class="preview-panel">
            <div class="preview-title">ğŸ‘€ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</div>
            <div class="preview-outer" id="previewOuter">
                <div class="preview-scaler" id="previewScaler">
                    <div class="a4-sheet portrait" id="a4Sheet">
                        <div class="sheet-inner" id="sheetInner"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ãƒ¢ãƒã‚¤ãƒ«ï¼šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ãï¼‰ -->
    <button class="mobile-preview-btn" id="mobilePreviewBtn">
        ğŸ‘€ ã˜ã‹ã‚“ã‚ã‚Šã‚’ã¿ã‚‹
    </button>

    <!-- ãƒ¢ãƒã‚¤ãƒ«ï¼šãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="mobile-modal-overlay" id="mobileModal">
        <div class="mobile-modal">
            <div class="mobile-modal-header">
                <span class="modal-title">ğŸ‘€ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</span>
                <button class="mobile-modal-close" id="mobileModalClose">âœ•</button>
            </div>
            <div class="mobile-modal-body">
                <div class="mobile-modal-preview-outer" id="mobilePreviewOuter">
                    <div class="mobile-modal-preview-scaler" id="mobilePreviewScaler">
                        <div class="a4-sheet portrait" id="mobileA4Sheet">
                            <div class="sheet-inner" id="mobileSheetInner"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mobile-modal-footer">
                <button class="mobile-pdf-btn" id="mobilePdfBtn">
                    ğŸ“„ PDFã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                </button>
            </div>
        </div>
    </div>

    <script>
        (function () {
            'use strict';

            // ===== ã‚«ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ =====
            // å„ãƒ†ãƒ¼ãƒ10è‰²ï¼šCMYKå°åˆ·å¯¾å¿œãƒ»ã‚·ãƒ¼ãƒˆå…¨ä½“ã®ãƒãƒ©ãƒ³ã‚¹ã‚’è€ƒæ…®ã—ãŸé…ç½®é †
            var COLOR_PATTERNS = [
                // 0: ãƒ“ãƒ“ãƒƒãƒˆï¼ˆCMYKå¯¾å¿œï¼šè›å…‰ç³»ã‚’é¿ã‘ã€æ··è‰²æ„Ÿã®ã‚ã‚‹é®®ã‚„ã‹è‰²ï¼‰
                // C/M/Y/Kã®æ›ã‘åˆã‚ã›ã§å†ç¾ã—ã‚„ã™ã„è‰²ç›¸ã‚’é¸å®š
                ['#E8446A', '#0097A7', '#E8720C', '#2E7D32', '#F9A825',
                    '#7B1FA2', '#C62828', '#00897B', '#EF6C00', '#1565C0'],
                // 1: ãƒ‘ã‚¹ãƒ†ãƒ«ï¼ˆCMYKå¯¾å¿œï¼šã‚„ã‚„æ¿ƒã„ã‚ã§ç™½é£›ã³é˜²æ­¢ã€å°åˆ·å¾Œã‚‚è‰²å‘³ãŒæ®‹ã‚‹ï¼‰
                ['#F48FB1', '#90CAF9', '#FFF176', '#A5D6A7', '#CE93D8',
                    '#FFAB91', '#80DEEA', '#F8BBD0', '#C5E1A5', '#FFE082'],
                // 2: ãƒŠãƒãƒ¥ãƒ©ãƒ«ï¼ˆã‚¢ãƒ¼ã‚¹ã‚«ãƒ©ãƒ¼ã¯CMYKè¦ªå’Œæ€§ãŒé«˜ã„ã€‚å¾®èª¿æ•´ã®ã¿ï¼‰
                ['#C58C6D', '#B7B7A4', '#DDBEA9', '#A3A88E', '#D4C5A9',
                    '#A8896C', '#C9C5B0', '#8B7355', '#E0C9B0', '#7A8C6E'],
                // 3: ã‚°ãƒ¬ãƒ¼ãƒˆãƒ¼ãƒ³ï¼ˆå°åˆ·ã§æ½°ã‚Œãªã„æ˜åº¦ãƒ»5ç•ªç›®ã‚’ä¸­æ˜åº¦ãƒ–ãƒ«ãƒ¼ã‚°ãƒ¬ãƒ¼ã«å¤‰æ›´ï¼‰
                ['#90A4AE', '#CFD8DC', '#78909C', '#B0BEC5', '#8FB5C1',
                    '#ADBCC4', '#D0D8DC', '#8FA0A8', '#E0E8EC', '#7EA8B4'],
            ];
            // ãƒ“ãƒ“ãƒƒãƒˆï¼ˆpattern=0ï¼‰ã®ã¿ç™½æ–‡å­—
            var VIVID_TEXT_WHITE = true;
            var currentPattern = 0;
            var LABEL_COLORS = COLOR_PATTERNS[currentPattern];
            // ãƒ†ãƒ¼ãƒé€£å‹•ã®ç•ªå·ãƒãƒƒã‚¸èƒŒæ™¯è‰²
            var NUM_BADGE_COLORS = [
                '#0097A7', // ãƒ“ãƒ“ãƒƒãƒˆï¼šãƒ†ã‚£ãƒ¼ãƒ«
                '#CE93D8', // ãƒ‘ã‚¹ãƒ†ãƒ«ï¼šãƒ©ãƒ™ãƒ³ãƒ€ãƒ¼
                '#6B705C', // ãƒŠãƒãƒ¥ãƒ©ãƒ«ï¼šæ¿ƒã„ã‚ªãƒªãƒ¼ãƒ–ï¼ˆãƒãƒƒã‚¸èƒŒæ™¯ç”¨ã€ç™½æ–‡å­—ã§è¦–èªæ€§OKï¼‰
                '#607D8B', // ã‚°ãƒ¬ãƒ¼ï¼šãƒ–ãƒ«ãƒ¼ã‚°ãƒ¬ãƒ¼
            ];
            var NUM_BADGE_TEXT_COLORS = [
                '#FFFFFF', // ãƒ“ãƒ“ãƒƒãƒˆï¼šç™½
                '#4A4A4A', // ãƒ‘ã‚¹ãƒ†ãƒ«ï¼šãƒ€ãƒ¼ã‚¯ã‚°ãƒ¬ãƒ¼
                '#FFFFFF', // ãƒŠãƒãƒ¥ãƒ©ãƒ«ï¼šç™½
                '#FFFFFF', // ã‚°ãƒ¬ãƒ¼ï¼šç™½
            ];

            var C = {
                dark: '#1A1A1A',
                blue: '#4A90E2',
                red: '#D94040',
                nameBox: '#4A90E2',
            };

            // A4 pxå¯¸æ³•
            var A4_P_W = 794, A4_P_H = 1123; // portrait
            var A4_L_W = 1123, A4_L_H = 794; // landscape

            var items = [];
            var nextId = 1;

            var HOURS = [];
            for (var h = 0; h < 24; h++) HOURS.push(h);
            var MINUTES = [0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55];

            var nameInput = document.getElementById('nameInput');
            var scheduleList = document.getElementById('scheduleList');
            var addBtn = document.getElementById('addBtn');
            var pdfBtn = document.getElementById('pdfBtn');
            var countInfo = document.getElementById('countInfo');
            var a4Sheet = document.getElementById('a4Sheet');
            var sheetInner = document.getElementById('sheetInner');
            var previewOuter = document.getElementById('previewOuter');
            var previewScaler = document.getElementById('previewScaler');
            // ãƒ¢ãƒã‚¤ãƒ«ç”¨è¦ç´ 
            var mobilePreviewBtn = document.getElementById('mobilePreviewBtn');
            var mobileModal = document.getElementById('mobileModal');
            var mobileModalClose = document.getElementById('mobileModalClose');
            var mobileA4Sheet = document.getElementById('mobileA4Sheet');
            var mobileSheetInner = document.getElementById('mobileSheetInner');
            var mobilePreviewOuter = document.getElementById('mobilePreviewOuter');
            var mobilePreviewScaler = document.getElementById('mobilePreviewScaler');
            var mobilePdfBtn = document.getElementById('mobilePdfBtn');

            nameInput.addEventListener('input', render);
            addBtn.addEventListener('click', function () { addItem(8, 0, ''); });
            pdfBtn.addEventListener('click', makePDF);

            // ãƒ¢ãƒã‚¤ãƒ«ï¼šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³â†’ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
            mobilePreviewBtn.addEventListener('click', function () {
                render();
                mobileModal.classList.add('open');
                document.body.style.overflow = 'hidden';
            });

            // ãƒ¢ãƒã‚¤ãƒ«ï¼šÃ—ãƒœã‚¿ãƒ³ã§é–‰ã˜ã‚‹
            mobileModalClose.addEventListener('click', function () {
                mobileModal.classList.remove('open');
                document.body.style.overflow = '';
            });

            // ãƒ¢ãƒã‚¤ãƒ«ï¼šã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ç‚¹ãƒƒã‚¯ã§é–‰ã˜ã‚‹
            mobileModal.addEventListener('click', function (e) {
                if (e.target === mobileModal) {
                    mobileModal.classList.remove('open');
                    document.body.style.overflow = '';
                }
            });

            // ãƒ¢ãƒã‚¤ãƒ«ï¼šPDFãƒœã‚¿ãƒ³
            mobilePdfBtn.addEventListener('click', makePDF);

            // ã‚«ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒœã‚¿ãƒ³
            document.querySelectorAll('.color-btn').forEach(function (btn) {
                btn.addEventListener('click', function () {
                    currentPattern = parseInt(this.dataset.pattern);
                    LABEL_COLORS = COLOR_PATTERNS[currentPattern];
                    document.querySelectorAll('.color-btn').forEach(function (b) { b.classList.remove('active'); });
                    this.classList.add('active');
                    render();
                });
            });

            // ===== ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ5é …ç›® =====
            addItem(6, 30, 'ã‚ã• ãŠãã‚‹');
            addItem(8, 0, 'ã‚ã•ã”ã¯ã‚“');
            addItem(9, 0, 'ãŒã£ã“ã†');
            addItem(15, 30, 'ãŠã‚„ã¤');
            addItem(19, 0, 'ã‚ˆã‚‹ã”ã¯ã‚“');

            function addItem(h, m, act) {
                if (items.length >= 10) return;
                items.push({ id: nextId++, hour: h, minute: m, activity: act });
                renderList();
                render();
            }

            function deleteItem(id) {
                items = items.filter(function (i) { return i.id !== id; });
                renderList();
                render();
            }

            function renderList() {
                scheduleList.innerHTML = '';
                items.forEach(function (item, idx) {
                    var div = document.createElement('div');
                    div.className = 'schedule-item';

                    var hourOpts = HOURS.map(function (h) {
                        return '<option value="' + h + '"' + (h === item.hour ? ' selected' : '') + '>' + pad(h) + '</option>';
                    }).join('');
                    var minOpts = MINUTES.map(function (m) {
                        return '<option value="' + m + '"' + (m === item.minute ? ' selected' : '') + '>' + pad(m) + '</option>';
                    }).join('');

                    div.innerHTML =
                        '<div class="item-header">' +
                        '<span style="font-size:0.78rem;font-weight:700;color:#999;">' + (idx + 1) + '</span>' +
                        '<button class="del-btn" data-id="' + item.id + '">âœ•</button>' +
                        '</div>' +
                        '<div class="time-act-row">' +
                        '<div class="time-row">' +
                        '<select class="time-sel" data-id="' + item.id + '" data-field="hour">' + hourOpts + '</select>' +
                        '<span class="colon">:</span>' +
                        '<select class="time-sel" data-id="' + item.id + '" data-field="minute">' + minOpts + '</select>' +
                        '</div>' +
                        '<input type="text" class="act-input" data-id="' + item.id + '" ' +
                        'placeholder="ã‚ˆã¦ã„ã‚’ã„ã‚Œã¦ã­" maxlength="15" value="' + esc(item.activity) + '">' +
                        '</div>';

                    scheduleList.appendChild(div);
                });

                scheduleList.querySelectorAll('.del-btn').forEach(function (btn) {
                    btn.addEventListener('click', function () { deleteItem(parseInt(this.dataset.id)); });
                });
                scheduleList.querySelectorAll('.time-sel').forEach(function (sel) {
                    sel.addEventListener('change', function () {
                        var id = parseInt(this.dataset.id);
                        var item = items.find(function (i) { return i.id === id; });
                        if (item) { item[this.dataset.field] = parseInt(this.value); render(); }
                    });
                });
                scheduleList.querySelectorAll('.act-input').forEach(function (inp) {
                    inp.addEventListener('input', function () {
                        var id = parseInt(this.dataset.id);
                        var item = items.find(function (i) { return i.id === id; });
                        if (item) { item.activity = this.value; render(); }
                    });
                });

                addBtn.disabled = items.length >= 10;
                var layout = items.length <= 5 ? 'A4ãŸã¦' : 'A4ã‚ˆã“ï¼ˆ2ã‚Œã¤ï¼‰';
                countInfo.innerHTML = 'ã‚ˆã¦ã„: ' + items.length + ' / 10' +
                    '<span class="layout-badge">' + layout + '</span>';
            }

            // ===== ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æç”» =====
            function render() {
                var name = nameInput.value || 'ã€€ã€€';
                var count = items.length;
                var isLandscape = count > 5;

                a4Sheet.className = 'a4-sheet ' + (isLandscape ? 'landscape' : 'portrait');

                // ã‚«ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¿œã˜ãŸname-boxã‚«ãƒ©ãƒ¼
                var titleColors = [
                    '#4A90E2', // ãƒ“ãƒ“ãƒƒãƒˆï¼šé’
                    '#F9A8D4', // ãƒ‘ã‚¹ãƒ†ãƒ«ï¼šãƒ”ãƒ³ã‚¯
                    '#C9A87C', // ãƒŠãƒãƒ¥ãƒ©ãƒ«ï¼šãƒ™ãƒ¼ã‚¸ãƒ¥
                    '#9E9E9E', // ã‚°ãƒ¬ãƒ¼ï¼šã‚°ãƒ¬ãƒ¼
                ];
                var titleBg = titleColors[currentPattern] || '#4A90E2';

                // ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆä¸­å¤®æƒãˆï¼‰
                var titleHTML =
                    '<div class="sheet-title">' +
                    '<div class="name-box">' + esc(name) + '</div>' +
                    '<div class="title-text">ã® ã˜ã‹ã‚“ã‚ã‚Š</div>' +
                    '</div>';

                // æ™‚è¨ˆã‚µã‚¤ã‚ºè¨ˆç®—
                // A4ç¸¦ï¼šå¸¸ã«178pxï¼ˆ1ã€œ5é …ç›®ï¼‰
                // A4æ¨ªï¼š6é …ç›®=160px, 7=148px, 8=136px, 9=124px, 10=112px ã¨æ®µéšçš„ã«ç¸®å°
                var clockSize, labelFontSize, entryPad;
                if (!isLandscape) {
                    clockSize = 178;
                    labelFontSize = '1.7rem';
                    entryPad = '0';
                } else {
                    // 7ãƒ»8é …ç›®ã¯136pxã€9ãƒ»10é …ç›®ã¯112px
                    var clockSizeMap = { 6: 160, 7: 136, 8: 136, 9: 112, 10: 112 };
                    clockSize = clockSizeMap[count] || 112;
                    // ãƒ©ãƒ™ãƒ«ãƒ•ã‚©ãƒ³ãƒˆã‚‚æ®µéšçš„ã«ç¸®å°
                    var labelFontMap = { 6: '1.3rem', 7: '1.1rem', 8: '1.1rem', 9: '0.95rem', 10: '0.95rem' };
                    labelFontSize = labelFontMap[count] || '0.95rem';
                    entryPad = '0';
                }

                var entriesHTML = '';
                var rowCount = isLandscape ? Math.ceil(count / 2) : count;
                // ãƒ“ãƒ“ãƒƒãƒˆæ™‚ã¯ç™½æ–‡å­—ã€ä»–ã¯é»’æ–‡å­—
                var labelTextColor = (currentPattern === 0) ? '#FFFFFF' : '#1A1A1A';
                // ãƒ†ãƒ¼ãƒé€£å‹•ã®ç•ªå·ãƒãƒƒã‚¸è‰²
                var numBadgeBg = NUM_BADGE_COLORS[currentPattern];
                var numBadgeFg = NUM_BADGE_TEXT_COLORS[currentPattern];

                if (isLandscape) {
                    for (var row = 0; row < rowCount; row++) {
                        var leftIdx = row;
                        var rightIdx = rowCount + row;
                        var item = items[leftIdx];
                        var bgColor = LABEL_COLORS[leftIdx % LABEL_COLORS.length];
                        var num = leftIdx + 1;
                        entriesHTML +=
                            '<div class="entry-row">' +
                            '<div class="entry-clock-wrap">' +
                            '<canvas class="entry-clock" width="' + clockSize + '" height="' + clockSize + '" ' +
                            'data-h="' + item.hour + '" data-m="' + item.minute + '"></canvas>' +
                            '<div class="entry-num" style="background:' + numBadgeBg + ';color:' + numBadgeFg + '">' + num + '</div>' +
                            '</div>' +
                            '<div class="entry-right">' +
                            '<div class="entry-label" style="font-size:' + labelFontSize + ';background:' + bgColor + ';color:' + labelTextColor + ';">' +
                            (item.activity ? esc(item.activity) : 'ã€€') +
                            '</div>' +
                            '<div class="entry-jikan">ã˜ã‹ã‚“</div>' +
                            '</div>' +
                            '</div>';
                        if (rightIdx < count) {
                            var item2 = items[rightIdx];
                            var bgColor2 = LABEL_COLORS[rightIdx % LABEL_COLORS.length];
                            var num2 = rightIdx + 1;
                            entriesHTML +=
                                '<div class="entry-row">' +
                                '<div class="entry-clock-wrap">' +
                                '<canvas class="entry-clock" width="' + clockSize + '" height="' + clockSize + '" ' +
                                'data-h="' + item2.hour + '" data-m="' + item2.minute + '"></canvas>' +
                                '<div class="entry-num" style="background:' + numBadgeBg + ';color:' + numBadgeFg + '">' + num2 + '</div>' +
                                '</div>' +
                                '<div class="entry-right">' +
                                '<div class="entry-label" style="font-size:' + labelFontSize + ';background:' + bgColor2 + ';color:' + labelTextColor + ';">' +
                                (item2.activity ? esc(item2.activity) : 'ã€€') +
                                '</div>' +
                                '<div class="entry-jikan">ã˜ã‹ã‚“</div>' +
                                '</div>' +
                                '</div>';
                        } else {
                            entriesHTML += '<div class="entry-row entry-empty"></div>';
                        }
                    }
                } else {
                    items.forEach(function (item, idx) {
                        var bgColor = LABEL_COLORS[idx % LABEL_COLORS.length];
                        entriesHTML +=
                            '<div class="entry-row" style="padding:' + entryPad + ';">' +
                            '<canvas class="entry-clock" width="' + clockSize + '" height="' + clockSize + '" ' +
                            'data-h="' + item.hour + '" data-m="' + item.minute + '"></canvas>' +
                            '<div class="entry-label" style="font-size:' + labelFontSize + ';background:' + bgColor + ';color:' + labelTextColor + ';">' +
                            (item.activity ? esc(item.activity) : 'ã€€') +
                            '</div>' +
                            '<div class="entry-jikan">ã˜ã‹ã‚“</div>' +
                            '</div>';
                    });
                }

                // entries-wrapã®ã‚¯ãƒ©ã‚¹æ±ºå®š
                var colClass;
                if (isLandscape) {
                    colClass = 'entries-wrap two-col';
                } else {
                    colClass = 'entries-wrap';
                }

                sheetInner.innerHTML = titleHTML + '<div class="' + colClass + '">' + entriesHTML + '</div>';

                sheetInner.querySelectorAll('canvas.entry-clock').forEach(function (cv) {
                    var r = cv.width / 2 - 4;
                    drawClock(cv.getContext('2d'), cv.width / 2, cv.height / 2, r,
                        parseInt(cv.dataset.h), parseInt(cv.dataset.m));
                });

                // ãƒ¢ãƒã‚¤ãƒ«ãƒ¢ãƒ¼ãƒ€ãƒ«ç”¨ã‚·ãƒ¼ãƒˆã«ã‚‚åŒã˜å†…å®¹ã‚’æç”»
                mobileSheetInner.innerHTML = titleHTML + '<div class="' + colClass + '">' + entriesHTML + '</div>';
                mobileSheetInner.querySelectorAll('canvas.entry-clock').forEach(function (cv) {
                    var r = cv.width / 2 - 4;
                    drawClock(cv.getContext('2d'), cv.width / 2, cv.height / 2, r,
                        parseInt(cv.dataset.h), parseInt(cv.dataset.m));
                });

                scalePreview();
            }

            // ===== ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ï¼šå¹…ãƒ»é«˜ã•ä¸¡æ–¹ã«åã¾ã‚‹ã‚ˆã†è¨ˆç®— =====
            function scalePreview() {
                var isLandscape = items.length > 5;
                var naturalW = isLandscape ? A4_L_W : A4_P_W;
                var naturalH = isLandscape ? A4_L_H : A4_P_H;

                // ã‚³ãƒ³ãƒ†ãƒŠã®a4Sheetã®ã‚¯ãƒ©ã‚¹ã‚’æ›´æ–°
                a4Sheet.className = 'a4-sheet ' + (isLandscape ? 'landscape' : 'portrait');
                mobileA4Sheet.className = 'a4-sheet ' + (isLandscape ? 'landscape' : 'portrait');

                // PCç”¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
                var outerW = previewOuter.clientWidth || 600;
                var outerH = previewOuter.clientHeight || 800;
                var scaleW = (outerW - 2) / naturalW;
                var scaleH = (outerH - 2) / naturalH;
                var scale = Math.min(scaleW, scaleH, 1);
                previewScaler.style.transform = 'scale(' + scale + ')';
                previewScaler.style.width = naturalW + 'px';
                previewScaler.style.height = naturalH + 'px';

                // ãƒ¢ãƒã‚¤ãƒ«ãƒ¢ãƒ¼ãƒ€ãƒ«å†…ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
                var mobileOuterW = mobilePreviewOuter.clientWidth || window.innerWidth;
                var mobileScale = Math.min((mobileOuterW - 24) / naturalW, 0.95);
                mobilePreviewScaler.style.transform = 'scale(' + mobileScale + ')';
                mobilePreviewScaler.style.width = naturalW + 'px';
                mobilePreviewScaler.style.height = naturalH + 'px';
            }

            window.addEventListener('resize', function () { scalePreview(); });

            // ===== ã‚¢ãƒŠãƒ­ã‚°æ™‚è¨ˆæç”» =====
            function drawClock(ctx, cx, cy, r, hour, minute) {
                // ç™½å¡—ã‚Š
                ctx.beginPath();
                ctx.arc(cx, cy, r, 0, Math.PI * 2);
                ctx.fillStyle = '#FFFFFF';
                ctx.fill();

                // å¤–æ ï¼ˆå°‘ã—ç´°ã‚ï¼‰
                var borderW = Math.max(5, r * 0.08);
                ctx.beginPath();
                ctx.arc(cx, cy, r, 0, Math.PI * 2);
                ctx.strokeStyle = C.dark;
                ctx.lineWidth = borderW;
                ctx.stroke();

                // æ•°å­—ï¼ˆ1ã€œ12ï¼‰ã®ã¿ãƒ»å°ã•ã‚ãƒ»å¤–å´ã«è©°ã‚ã‚‹
                var numR = r * 0.76;
                var fontSize = Math.round(r * 0.18);
                // Zen Maru Gothicã‚’ä½¿ç”¨ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ï¼‰
                ctx.font = 'bold ' + fontSize + 'px \'Zen Maru Gothic\', sans-serif';
                ctx.fillStyle = C.dark;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                for (var n = 1; n <= 12; n++) {
                    var ang = (n / 12) * Math.PI * 2 - Math.PI / 2;
                    ctx.fillText(String(n), cx + numR * Math.cos(ang), cy + numR * Math.sin(ang));
                }

                // åˆ†é‡ï¼ˆé’ãƒ»é•·ãƒ»ç´°ï¼‰â†’ èƒŒé¢
                var ma = (minute / 60) * Math.PI * 2 - Math.PI / 2;
                ctx.beginPath();
                ctx.moveTo(cx, cy);
                ctx.lineTo(cx + r * 0.72 * Math.cos(ma), cy + r * 0.72 * Math.sin(ma));
                ctx.strokeStyle = C.blue;
                ctx.lineWidth = Math.max(3, r * 0.055);
                ctx.lineCap = 'round';
                ctx.stroke();

                // æ™‚é‡ï¼ˆèµ¤ãƒ»çŸ­ãƒ»å¤ªï¼‰â†’ å‰é¢
                var ha = ((hour % 12 + minute / 60) / 12) * Math.PI * 2 - Math.PI / 2;
                ctx.beginPath();
                ctx.moveTo(cx, cy);
                ctx.lineTo(cx + r * 0.50 * Math.cos(ha), cy + r * 0.50 * Math.sin(ha));
                ctx.strokeStyle = C.red;
                ctx.lineWidth = Math.max(5, r * 0.10);
                ctx.lineCap = 'round';
                ctx.stroke();

                // ä¸­å¿ƒç‚¹ï¼ˆé»’ï¼‰
                ctx.beginPath();
                ctx.arc(cx, cy, Math.max(4, r * 0.07), 0, Math.PI * 2);
                ctx.fillStyle = C.dark;
                ctx.fill();
            }

            // ===== PDFç”Ÿæˆ =====
            function makePDF() {
                var name = nameInput.value || 'noname';
                var count = items.length;
                var isLandscape = count > 5;

                var pxW = isLandscape ? A4_L_W : A4_P_W;
                var pxH = isLandscape ? A4_L_H : A4_P_H;
                var scale = 2;

                var canvas = document.createElement('canvas');
                canvas.width = pxW * scale;
                canvas.height = pxH * scale;
                var ctx = canvas.getContext('2d');
                ctx.scale(scale, scale);

                var font = "'Zen Maru Gothic', 'Hiragino Kaku Gothic ProN', 'Meiryo', sans-serif";

                ctx.fillStyle = 'white';
                ctx.fillRect(0, 0, pxW, pxH);

                var nameVal = nameInput.value || 'ã€€ã€€';
                var padX = 52, padY = 44;

                // ===== ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆä¸­å¤®æƒãˆï¼‰ =====
                var titleFontSize = 36;
                ctx.font = '700 ' + titleFontSize + 'px ' + font;
                ctx.textBaseline = 'middle';

                var suffix = ' ã® ã˜ã‹ã‚“ã‚ã‚Š';
                var nameW = ctx.measureText(nameVal).width;
                var suffixW = ctx.measureText(suffix).width;
                var boxPadX = 24, boxH = 54;
                var boxW = Math.max(nameW + boxPadX * 2, 100);
                var totalW = boxW + suffixW + 8;
                var titleY = padY + boxH / 2;
                var startX = (pxW - totalW) / 2;

                ctx.fillStyle = C.nameBox;
                rrect(ctx, startX, titleY - boxH / 2, boxW, boxH, 12);
                ctx.fill();
                ctx.fillStyle = '#FFFFFF';
                ctx.textAlign = 'center';
                ctx.fillText(nameVal, startX + boxW / 2, titleY);

                ctx.fillStyle = C.dark;
                ctx.textAlign = 'left';
                ctx.fillText(suffix, startX + boxW + 8, titleY);

                // ===== ã‚¨ãƒ³ãƒˆãƒª =====
                var entryStartY = titleY + boxH / 2 + 20;
                var availH = pxH - entryStartY - padY;
                var availW = pxW - padX * 2;

                if (!isLandscape) {
                    // ç¸¦1ã‚«ãƒ©ãƒ 
                    // æ™‚è¨ˆã‚µã‚¤ã‚ºï¼š5é …ç›®ã§A4ã„ã£ã±ã„ã«ãªã‚‹ã‚ˆã†è¨ˆç®—
                    var entryH = availH / Math.max(count, 1);
                    var clockR = Math.min(Math.floor(entryH * 0.44), 80);
                    var clockD = clockR * 2;
                    var ecxBase = padX + clockR;

                    items.forEach(function (item, i) {
                        var ecy = entryStartY + i * entryH + entryH / 2;

                        drawClock(ctx, ecxBase, ecy, clockR - 2, item.hour, item.minute);

                        var lx = padX + clockD + 18;
                        var lw = availW - clockD - 18 - 70;
                        var lh = Math.min(entryH - 14, clockD * 0.70);
                        var ly = ecy - lh / 2;
                        var bgColor = LABEL_COLORS[i % LABEL_COLORS.length];
                        // ãƒ“ãƒ“ãƒƒãƒˆæ™‚ã¯ç™½æ–‡å­—ã€ä»–ã¯é»’æ–‡å­—
                        var pdfLabelColor = (currentPattern === 0) ? '#FFFFFF' : C.dark;

                        ctx.fillStyle = bgColor;
                        rrect(ctx, lx, ly, lw, lh, 16);
                        ctx.fill();

                        var af = Math.min(34, lh * 0.50);
                        ctx.font = '700 ' + af + 'px ' + font;
                        ctx.fillStyle = pdfLabelColor;
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.fillText(item.activity || '', lx + lw / 2, ecy);

                        ctx.font = '700 22px ' + font;
                        ctx.fillStyle = C.dark;
                        ctx.textAlign = 'left';
                        ctx.fillText('ã˜ã‹ã‚“', lx + lw + 10, ecy);
                    });

                } else {
                    // æ¨ª2ã‚«ãƒ©ãƒ 
                    var colW = (availW - 40) / 2;
                    var rowCount = Math.ceil(count / 2);
                    var entryH2 = availH / Math.max(rowCount, 1);
                    var clockR2 = Math.min(Math.floor(entryH2 * 0.42), 54);
                    var clockD2 = clockR2 * 2;

                    // ãƒ“ãƒ“ãƒƒãƒˆæ™‚ã¯ç™½æ–‡å­—ã€ä»–ã¯é»’æ–‡å­—
                    var pdfLabelColor2 = (currentPattern === 0) ? '#FFFFFF' : C.dark;
                    // ãƒ†ãƒ¼ãƒé€£å‹•ã®ç•ªå·ãƒãƒƒã‚¸è‰²
                    var pdfNumBg = NUM_BADGE_COLORS[currentPattern];
                    var pdfNumFg = NUM_BADGE_TEXT_COLORS[currentPattern];

                    ctx.strokeStyle = '#E0E0E0';
                    ctx.lineWidth = 1;
                    ctx.setLineDash([]);
                    ctx.beginPath();
                    ctx.moveTo(pxW / 2, entryStartY - 10);
                    ctx.lineTo(pxW / 2, pxH - padY);
                    ctx.stroke();

                    // å·¦åˆ—: items[0]ã€œitems[rowCount-1]ã€å³åˆ—: items[rowCount]ã€œitems[count-1]
                    for (var pdfRow = 0; pdfRow < rowCount; pdfRow++) {
                        var pdfIndices = [pdfRow, rowCount + pdfRow];
                        pdfIndices.forEach(function (i) {
                            if (i >= count) return;
                            var col = i < rowCount ? 0 : 1;
                            var row = i < rowCount ? i : i - rowCount;
                            var colStartX = padX + col * (colW + 40);
                            var ecy = entryStartY + row * entryH2 + entryH2 / 2;
                            var ecx = colStartX + clockR2 + 6;

                            drawClock(ctx, ecx, ecy, clockR2 - 2, items[i].hour, items[i].minute);

                            // ç•ªå·ã‚’æ™‚è¨ˆã®å·¦ä¸Šã«æç”»ï¼ˆãƒ†ãƒ¼ãƒé€£å‹•è‰²ï¼‰
                            var numR2 = clockR2 * 0.28;
                            var numCx = ecx - clockR2 * 0.65;
                            var numCy = ecy - clockR2 * 0.65;
                            ctx.beginPath();
                            ctx.arc(numCx, numCy, numR2, 0, Math.PI * 2);
                            ctx.fillStyle = pdfNumBg;
                            ctx.fill();
                            ctx.font = 'bold ' + Math.round(numR2 * 1.2) + 'px ' + font;
                            ctx.fillStyle = pdfNumFg;
                            ctx.textAlign = 'center';
                            ctx.textBaseline = 'middle';
                            ctx.fillText(String(i + 1), numCx, numCy);

                            var lx2 = colStartX + clockD2 + 14;
                            var lw2 = colW - clockD2 - 14 - 52;
                            var lh2 = Math.min(entryH2 - 12, clockD2 * 0.70);
                            var ly2 = ecy - lh2 / 2;
                            var bgColor2 = LABEL_COLORS[i % LABEL_COLORS.length];

                            ctx.fillStyle = bgColor2;
                            rrect(ctx, lx2, ly2, lw2, lh2, 14);
                            ctx.fill();

                            var af2 = Math.min(26, lh2 * 0.50);
                            ctx.font = '700 ' + af2 + 'px ' + font;
                            ctx.fillStyle = pdfLabelColor2;
                            ctx.textAlign = 'center';
                            ctx.textBaseline = 'middle';
                            ctx.fillText(items[i].activity || '', lx2 + lw2 / 2, ecy);

                            // ã˜ã‹ã‚“ãƒ†ã‚­ã‚¹ãƒˆã¯è¡Œå‹•å†…å®¹ã¨ä¸­å¤®æƒãˆ
                            var jikanF = Math.min(18, af2 * 0.75);
                            ctx.font = '700 ' + jikanF + 'px ' + font;
                            ctx.fillStyle = C.dark;
                            ctx.textAlign = 'left';
                            ctx.fillText('ã˜ã‹ã‚“', lx2 + lw2 + 6, ecy);
                        });
                    }
                }

                // JPEGåœ§ç¸®ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’å¤§å¹…å‰Šæ¸›
                var imgData = canvas.toDataURL('image/jpeg', 0.88);
                var jsPDF = window.jspdf.jsPDF;
                var doc = new jsPDF({
                    orientation: isLandscape ? 'landscape' : 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });
                var pdfW = isLandscape ? 297 : 210;
                var pdfH = isLandscape ? 210 : 297;
                doc.addImage(imgData, 'JPEG', 0, 0, pdfW, pdfH);
                doc.save('ã˜ã‹ã‚“ã‚ã‚Š_' + name + '.pdf');
            }

            function rrect(ctx, x, y, w, h, r) {
                ctx.beginPath();
                ctx.moveTo(x + r, y);
                ctx.lineTo(x + w - r, y);
                ctx.quadraticCurveTo(x + w, y, x + w, y + r);
                ctx.lineTo(x + w, y + h - r);
                ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
                ctx.lineTo(x + r, y + h);
                ctx.quadraticCurveTo(x, y + h, x, y + h - r);
                ctx.lineTo(x, y + r);
                ctx.quadraticCurveTo(x, y, x + r, y);
                ctx.closePath();
            }

            function esc(s) {
                return String(s || '')
                    .replace(/&/g, '&amp;').replace(/</g, '&lt;')
                    .replace(/>/g, '&gt;').replace(/"/g, '&quot;');
            }
            function pad(n) { return n < 10 ? '0' + n : String(n); }

        })();
    </script>
</body>

</html>